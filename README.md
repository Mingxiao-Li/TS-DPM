# Alleviating Exposure Bias in Diffusion Models through Sampling with Shifted Time Steps
This repo contains the official implementation for the paper [Alleviating Exposure Bias in Diffusion Models through Sampling with Shifted Time Steps](https://arxiv.org/pdf/2305.15583.pdf)  


by [Mingxiao Li*](https://github.com/Mingxiao-Li), Tingyu Qu*, Ruicong Yao, Wei Sun, Marie-Francine Moens. International Conference on Representation Learning 2024 (ICLR'24).

## Abstract
<div stype="text-align: left;">
Denoising Diffusion Probabilistic Models (DDPM) have shown remarkable efficacy in the synthesis of high-quality images. However, their inference process characteristically requires numerous, potentially hundreds, of iterative steps, which could lead to the problem of exposure bias due to the accumulation of prediction errors over iterations. Previous work has attempted to mitigate this issue by perturbing inputs during training, which consequently mandates the retraining of the DDPM. In this work, we conduct a systematic study of exposure bias in diffusion models and, intriguingly, we find that the exposure bias could be alleviated with a new sampling method, without retraining the model. We empirically and theoretically show that, during inference, for each backward time step  and corresponding state , there might exist another time step  which exhibits superior coupling with . Based on this finding, we introduce an inference method named Time-Shift Sampler. Our framework can be seamlessly integrated with existing sampling algorithms, such as DDIM or DDPM, inducing merely minimal additional computations. Experimental results show that our proposed framework can effectively enhance the quality of images generated by existing sampling algorithms.
</div>

## Illustration of Our Method
![flowchar-img](figures/ts_dpm.png)

## What does this codebase contain ?

This codebase comprises the integration of our TS-method with a wide array of popular diffusion samplers including [DDIM](https://arxiv.org/pdf/2010.02502.pdf), [PNDM](https://arxiv.org/pdf/2202.09778.pdf), [DPM-Solver](https://arxiv.org/abs/2206.00927), and [DEIS] (https://arxiv.org/abs/2204.13902). 

For the implementation of our method on [ADM](https://arxiv.org/pdf/2105.05233.pdf) backbone, please visit [this repo](https://github.com/tingyu215/TS-DPM-ADM).

## Installation
